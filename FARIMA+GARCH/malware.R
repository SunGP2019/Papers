mal=read.csv("/Users/mxu2/Dropbox/Shouhuai-related/malware-attack-data/data-table.csv")

mal1=read.csv("I:/dropbox/Dropbox/Shouhuai-related/malware-attack-data/data-table.csv")



ind=c("H","M","L")
mal1=mal[order(factor(mal[,4],levels=ind)),]

sum(mal1$nov_h)
sum(mal1$nov_m)
sum(mal1$nov_l)

summary(mal[,5])
sum(mal$soph_l)
sum(mal$soph_m)

#################newness analysis#####
mal1$newness=as.character(mal[,4])
mal1[mal1$newness=="L",8]=c("Low")
mal1[mal1$newness=="M",8]=c("Medium")
mal1[mal1$newness=="H",8]=c("High")



mal1$sop=as.character(mal[,5])
mal1[mal1$sop=="H",9]="High"
mal1[mal1$sop=="M",9]="Low"
mal1[mal1$sop=="L",9]="Low"

#################


summary(mal1[,14])
summary(mal1[,15])


##########correlation analysis between newness and sop############

mal1[mal1$Sophistication=="L",10]=0
mal1[mal1$Sophistication=="M",10]=0
mal1[mal1$Sophistication=="H",10]=1

mal1[mal1$newness.novelty=="L",11]=0
mal1[mal1$newness.novelty=="M",11]=1
mal1[mal1$newness.novelty=="H",11]=2

cor.test(mal1[,10],as.numeric(mal1[,11]), method = c("kendall"))

chisq.test(mal1$newness,mal1$sop)
z=chisq.test(mal1$newness.novelty,mal1$Sophistication,simulate.p.value=TRUE)

z$parameter

lm1=lm(X.bytes.in.report~sop,data=mal1)
summary(lm1)

lm2=lm(X.bytes.in.report~newness,data=mal1)
summary(lm2)

anova(lm2)

########################
anov=aov(X.bytes.in.report~sop,data=mal1)
summary(anov)
TukeyHSD(anov)
kruskal.test(X.bytes.in.report~sop,data=mal1)


######EDA#####
mal1$newness1=factor(mal1$newness,levels = c("High", "Medium", "Low"))
mal1$sop1=factor(mal1$sop,levels = c("High", "Low"))

setwd("I:/dropbox/Dropbox/Shouhuai-related/Zheyuan-Research/Paper-1/")
pdf(file ="newness.pdf")
op<-par(mar=c(5,5,1,1),cex.axis=1.5,font.axis=2,font.lab=2,cex.main=2,cex.lab=1.6)  
plot(mal1$X.bytes.in.report~as.factor(mal1$newness1),ylab="Attack report length",xlab="Newness")
par(op)
dev.off()

# pdf(file ="sop.pdf")
# op<-par(mar=c(5,5,1,1),cex.axis=1.5,font.axis=2,font.lab=2,cex.main=2,cex.lab=1.6)  
# plot(no.byt~nov,ylab="Number of bytes",xlab="Novelty")
# par(op)
# dev.off()

pdf(file ="sop.pdf")
op<-par(mar=c(5,5,1,1),cex.axis=1.5,font.axis=2,font.lab=2,cex.main=2,cex.lab=1.6)  
plot(mal1$X.bytes.in.report~mal1$sop1,ylab="Attack report length",xlab="Sophistication")
par(op)
dev.off()

# pdf(file ="no_bytes_soph.pdf")
# op<-par(mar=c(5,5,1,1),cex.axis=1.5,font.axis=2,font.lab=2,cex.main=2,cex.lab=1.6)  
# plot(no.byt~soph,ylab="Number of bytes",xlab="Sophistication")
# par(op)
# dev.off()
#######################regression analysis##################

lm1=lm(no.byt~soph)
summary(lm1)
lm2=lm(no.byt~nov)
summary(lm2)
lm3=lm(no.words~nov)
summary(lm3)
lm4=lm(no.words~soph)
summary(lm4)
plot(residuals(lm2)~fitted(lm1))

#########anova analysis####
anov=aov(no.byt~soph)
summary(anov)
TukeyHSD(anov)
kruskal.test(no.byt~soph)

nol=no.byt[nov=="L"]
noh=no.byt[nov=="H"]

g=factor(rep(1:2,c(length(nol),length(nom))))
g1=factor(rep(1:2,c(length(nom),length(noh))))
g3=factor(rep(1:2,c(length(nol),length(noh))))

kruskal.test(c(nol,nom),g)
kruskal.test(c(nom,noh),g1)
kruskal.test(c(nol,noh),g3)
